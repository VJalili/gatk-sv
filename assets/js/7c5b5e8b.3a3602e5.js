"use strict";(self.webpackChunkGATK_SV=self.webpackChunkGATK_SV||[]).push([[268],{4036:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>g,frontMatter:()=>o,metadata:()=>c,toc:()=>u});var i=t(4848),r=t(8453),s=t(1470),a=t(9365);const o={title:"Manual Deployment",description:"Build and Publish Images",sidebar_position:3},l=void 0,c={id:"advanced/docker/deploy/manual",title:"Manual Deployment",description:"Build and Publish Images",source:"@site/docs/advanced/docker/deploy/manual.md",sourceDirName:"advanced/docker/deploy",slug:"/advanced/docker/deploy/manual",permalink:"/gatk-sv/docs/advanced/docker/deploy/manual",draft:!1,unlisted:!1,editUrl:"https://github.com/broadinstitute/gatk-sv/tree/master/website/docs/advanced/docker/deploy/manual.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Manual Deployment",description:"Build and Publish Images",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Automated Deployment",permalink:"/gatk-sv/docs/advanced/docker/deploy/automated"},next:{title:"Incremental Publishing",permalink:"/gatk-sv/docs/advanced/docker/deploy/incremental"}},d={},u=[{value:"Setup",id:"setup",level:2},{value:"Runtime environment",id:"runtime",level:3},{value:"Docker",id:"docker",level:3},{value:"Checkout codebase",id:"checkout",level:3},{value:"Build and Publish Docker Images",id:"build",level:2},{value:"Determine which images need to be rebuilt",id:"targets",level:3},{value:"Image tag",id:"tag",level:3},{value:"Specify the container registry",id:"registry",level:3},{value:"Post-build",id:"post-build",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"If you are contributing to the GATK-SV codebase, specifically focusing on\nenhancing tools, configuring dependencies in Dockerfiles, or modifying GATK-SV scripts\nwithin the Docker images, it is important to build and test the Docker images locally.\nThis ensures that the images are successfully built and function as intended."}),"\n",(0,i.jsx)(n.p,{children:"The process of updating GATK-SV Docker images involves two steps: build and publish."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Build"}),": Create Docker images from Dockerfiles and store them on your computer."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Publish"}),": Upload the built Docker images to container registries\n(e.g., Google Container registry, or Azure container registry)\nto make them available for use in Terra or Cromwell."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You may refer to ",(0,i.jsx)(n.a,{href:"/gatk-sv/docs/advanced/docker/",children:"this page"})," for detailed description of the process.\nTo streamline the process, we have developed a Python script\nthat automates the image building and publishing to your container registry.\nThis section provides guidelines on building and publishing the images using this script."]}),"\n",(0,i.jsx)(n.admonition,{title:"Linux Machine Required",type:"warning",children:(0,i.jsx)(n.p,{children:"Only Linux machines (dedicated or virtual) are supported for building GATK-SV Docker images.\nImages created on non-Linux machines may not work with Terra or Cromwell execution environment.\nThe instructions provided on this page assume you are using a Linux Ubuntu machine."})}),"\n",(0,i.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsx)(n.h3,{id:"runtime",children:"Runtime environment"}),"\n",(0,i.jsxs)(n.p,{children:["Currently, GATK-SV Docker images can only be built on the ",(0,i.jsx)(n.code,{children:"linux/amd64"})," platform,\nwhich is a machine running Linux OS on x86-64 architecture.\nImages build on Apple M1 (",(0,i.jsx)(n.code,{children:"linux/arm64"}),") are not currently supported.\nYou can use a local Linux machine or obtain a virtual machine from a cloud platform."]}),"\n",(0,i.jsxs)(n.p,{children:["You may follow the steps in the\n",(0,i.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/instances/create-start-instance#publicimage",children:"GCP"}),"\nor ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/virtual-machines/windows/quick-create-portal",children:"Azure"}),"\ndocumentation to create a virtual machine (VM) on Google Cloud Platform (GCP) or Microsoft Azure respectively.\nMake sure the VM is built using an Ubuntu image, has at least 8 GB RAM, and some additional\ndisk space (e.g., 50 GB should be sufficient)."]}),"\n",(0,i.jsxs)(n.p,{children:["Building and publishing GATK-SV Docker images is time-consuming and can take around 1 hour.\nTherefore, we recommend using a terminal multiplexer\n(e.g., ",(0,i.jsx)(n.a,{href:"https://github.com/tmux/tmux/wiki/Getting-Started",children:"tmux"}),";\n",(0,i.jsx)(n.a,{href:"https://tmuxcheatsheet.com",children:"tmux cheat sheet"}),")\nwhen running on a VM to ensure the process continues even if you are disconnected from the VM."]}),"\n",(0,i.jsx)(n.h3,{id:"docker",children:"Docker"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"Install"})," Docker desktop\nand login using ",(0,i.jsx)(n.code,{children:"sudo docker login"}),". If utilizing GATK-SV Docker images\nfrom a private container registry or intending to publish the resulting\nimages to a registry, ensure that you are logged in with credentials\nthat grant you access to the registry."]}),"\n",(0,i.jsxs)(s.A,{groupId:"cr",defaultValue:"gcr",values:[{label:"ACR",value:"acr"},{label:"GCR",value:"gcr"}],children:[(0,i.jsx)(a.A,{value:"acr",children:(0,i.jsxs)(n.p,{children:["You may follow\n",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/container-registry/container-registry-authentication?tabs=azure-cli",children:"this documentation"}),"\non setting up Docker authentication to an Azure container registry."]})}),(0,i.jsx)(a.A,{value:"gcr",children:(0,i.jsxs)(n.p,{children:["You may follow\n",(0,i.jsx)(n.a,{href:"https://cloud.google.com/artifact-registry/docs/docker/authentication",children:"this documentation"}),"\non setting up Docker authentication to a Google container registry."]})})]}),"\n",(0,i.jsx)(n.h3,{id:"checkout",children:"Checkout codebase"}),"\n",(0,i.jsxs)(n.p,{children:["Make sure you are on the ",(0,i.jsx)(n.code,{children:"git"})," branch with the code you want to add\nto the GATK-SV Docker images you are building."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"git fetch origin <branch_name>\ngit checkout origin/<branch_name>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"build",children:"Build and Publish Docker Images"}),"\n",(0,i.jsxs)(n.p,{children:["All the GATK-SV Dockerfiles are hosted under the directory\n",(0,i.jsx)(n.a,{href:"https://github.com/broadinstitute/gatk-sv/tree/main/dockerfiles",children:(0,i.jsx)(n.code,{children:"gatk-sv/dockerfiles/"})}),".\nWhile you can build the GATK-SV Docker images by following the standard\n",(0,i.jsx)(n.a,{href:"https://docs.docker.com/engine/reference/commandline/image_build/",children:"Docker image build procedures"}),",\nthat can be challenging due to the nested hierarchy of GATK-SV Docker images.\nTo simplify the process, we have developed a utility script that streamlines the\nDocker image build process\n(",(0,i.jsx)(n.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/scripts/docker/build_docker.py",children:(0,i.jsx)(n.code,{children:"scripts/docker/build_docker.py"})}),")."]}),"\n",(0,i.jsx)(n.p,{children:"In the following, we will explain how to use the utility script for a simple use-case.\nFor more advanced and additional functionalities, please refer to the script's documentation,\nwhich you may access it as the following."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py --help \n"})}),"\n",(0,i.jsxs)(n.p,{children:["In its basic setup, you can use the following command to ",(0,i.jsx)(n.strong,{children:"build and publish"})," a GATK-SV Docker image."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n    --targets <images> \\\n    --image-tag <tag> \\\n    --docker-repo <container registry>\n"})}),"\n",(0,i.jsx)(n.p,{children:"The arguments used are explained in the following."}),"\n",(0,i.jsx)(n.h3,{id:"targets",children:"Determine which images need to be rebuilt"}),"\n",(0,i.jsx)(n.p,{children:"You may follow either of the following practices to determine which images to rebuild."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Automatic:"}),"\nThe script can automatically determine which Docker images need a rebuild\nbased on a list of changed files and cross-referencing them with the\ntable in ",(0,i.jsx)(n.a,{href:"/docs/advanced/docker/images#list",children:"this section"}),".\nSpecifically, it takes two git commit SHAs as input, uses ",(0,i.jsx)(n.code,{children:"git diff"}),"\nto extract the list of changed files, and then cross-referencing them\nwith ",(0,i.jsx)(n.a,{href:"/docs/advanced/docker/images#list",children:"this table"})," to identify the Docker\nimages requiring rebuilding. Details can be found on ",(0,i.jsx)(n.a,{href:"/gatk-sv/docs/advanced/docker/deploy/incremental",children:"this page"}),".\nTo use this feature, commit the changes first, identify ",(0,i.jsx)(n.code,{children:"BASE_SHA"})," and ",(0,i.jsx)(n.code,{children:"HEAD_SHA"})," using ",(0,i.jsx)(n.code,{children:"git log"})," or GitHub\n(details on ",(0,i.jsx)(n.a,{href:"/gatk-sv/docs/advanced/docker/deploy/incremental",children:"this page"}),"),\nand then call the script as follows."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n    --base-git-commit BASE_SHA \\\n    --current-git-commit HEAD_SHA\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["**Manual: **\nYou may refer to the table in ",(0,i.jsx)(n.a,{href:"/docs/advanced/docker/images#list",children:"this section"}),"\nto determine which Docker images to rebuild based on the changed files.\nFor instance, if you modified any of the files under the\n",(0,i.jsx)(n.a,{href:"https://github.com/broadinstitute/gatk-sv/tree/main/src/svtk",children:(0,i.jsx)(n.code,{children:"gatk-sv/src/svtk/"})}),"\ndirectory, you will need to rebuild the ",(0,i.jsx)(n.code,{children:"sv-pipeline"})," Docker image.\nYou can set the list of images to rebuild using the ",(0,i.jsx)(n.code,{children:"--targets"})," argument.\nFor instance:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n    --targets sv-pipeline\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You may specify multiple images to rebuild by providing a list of their names.\nFor instance, the following command builds the ",(0,i.jsx)(n.code,{children:"sv-pipeline"})," and the ",(0,i.jsx)(n.code,{children:"str"})," Docker images."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n    --targets sv-pipeline str\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Please note that ",(0,i.jsx)(n.code,{children:"--targets"})," and ",(0,i.jsx)(n.code,{children:"--base-git-commit --current-git-commit"}),"\noptions are mutually exclusive. In other words, you can either manually specify\nimages to rebuild, or let the script determine them.\nCombining or avoiding both options is not currently supported."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Following the steps above, the script builds the specified Docker images\n",(0,i.jsx)(n.em,{children:"and all the images derived from them"}),", ensuring proper propagation of changes through the pipeline.\nIf you want to build only the specified images, you would need to add the ",(0,i.jsx)(n.code,{children:"--skip-dependent-images"})," flag."]})}),"\n",(0,i.jsx)(n.h3,{id:"tag",children:"Image tag"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://docs.docker.com/engine/reference/commandline/tag/",children:"Docker image tags"}),"\nare used to distinguish between different builds of the same image.\nYou can use any naming convention for your tags.\nGATK-SV docker images use the following template for tags,\nwhich you may want to adopt, in particular, if you plan to publish\nyour images on the GATK-SV container registries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[Date]-[Release Tag]-[Head SHA 8]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["where ",(0,i.jsx)(n.code,{children:"[Date]"})," is ",(0,i.jsx)(n.code,{children:"YYYY-MM-DD"})," extracted from the time stamp of the last\ncommit on the feature branch, ",(0,i.jsx)(n.code,{children:"[Release Tag]"})," is extracted from the latest [pre-]release on GitHub,\nand the ",(0,i.jsx)(n.code,{children:"[Head SHA 8]"})," is the first eight letters of the SHA of the\nlast commit on the feature branch."]}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"2023-07-28-v0.28.1-beta-e70dfbd7\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For automatically composing image tags, you may follow the practices\nused in ",(0,i.jsx)(n.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/286a87f3bcfc0b8c811ff789776dd0b135f582e9/.github/workflows/sv_pipeline_docker.yml#L85-L109",children:"GATK-SV CI/CD"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"registry",children:"Specify the container registry"}),"\n",(0,i.jsxs)(n.p,{children:["The built images are stored on your computer. If you are only developing\nor testing locally, there is no need to push them to a container registry.\nIn this case you can avoid providing ",(0,i.jsx)(n.code,{children:"--docker-repo <registry>"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"You need to push the images to a container registry if you want to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use the updated Docker images for WDL testing or development;"}),"\n",(0,i.jsx)(n.li,{children:"Store them on a container registry other than those maintained by the GATK-SV team."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The script automatically pushes Docker images to a container registry.\nTo use this feature, you may follow these steps:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Ensure you are logged into Docker with credentials granting\npush access to the container registry. Please refer to the\n",(0,i.jsx)(n.a,{href:"#docker",children:"Docker"})," section for details."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Provide the ",(0,i.jsx)(n.code,{children:"--docker-repo <registry>"})," argument,\nreplacing ",(0,i.jsx)(n.code,{children:"<registry>"})," with the name of your container registry.\nFor Google Container Registry (GCR) and Azure Container Registry (ACR),\nthe format is generally as follows."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.A,{groupId:"cr",defaultValue:"gcr",values:[{label:"ACR",value:"acr"},{label:"GCR",value:"gcr"}],children:[(0,i.jsxs)(a.A,{value:"acr",children:[(0,i.jsx)(n.p,{children:"Template:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"<registry>.azurecr.io/<repository>/<image>:<tag>\n"})}),(0,i.jsx)(n.p,{children:"Example:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n   --targets sv-pipeline\n   --tag v1\n   --docker-repo myregistry.azurecr.io/gatk-sv\n"})}),(0,i.jsx)(n.p,{children:"which results in creating the following image:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"myregistry.azurecr.io/gatk-sv/sv-pipeline:v1\n"})})]}),(0,i.jsxs)(a.A,{value:"gcr",children:[(0,i.jsx)(n.p,{children:"Template:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"<host name>/<repository>/<image>:<tag>\n"})}),(0,i.jsx)(n.p,{children:"Example:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"python scripts/docker/build_docker.py \\\n   --targets sv-pipeline\n   --tag v1\n   --docker-repo us.gcr.io/my-repository/gatk-sv\n"})}),(0,i.jsx)(n.p,{children:"which results in creating the following image:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"us.gcr.io/my-repository/gatk-sv/sv-pipeline:v1\n"})})]})]}),"\n",(0,i.jsx)(n.p,{children:"Please note that we are currently using GCR, but it has been migrated to Google Artifact Registry."}),"\n",(0,i.jsx)(n.h2,{id:"post-build",children:"Post-build"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"GATK-SV docker images are mainly intended for use in WDLs.\nTherefore, it's a good practice to test the newly updated\nimages in related WDLs. This ensures that the updated images function\nas expected within specific workflows."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If you were using a Linux VM to build the Docker images,\nensure you either stop or delete the VM after building the images.\nStopping the VM won't delete the disk, and you'll continue to\nincur disk usage charges. If you don't want to incur disk costs,\nyou can delete the VM along with all its associated resources.\nStopping is preferred over deleting if you intend to reuse the VM."}),"\n"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var i=t(4164);const r={tabItem:"tabItem_Ymn6"};var s=t(4848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,i.A)(r.tabItem,a),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>k});var i=t(6540),r=t(4164),s=t(3104),a=t(6347),o=t(205),l=t(7485),c=t(1682),d=t(9466);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:r}}=e;return{value:n,label:t,attributes:i,default:r}}))}(t);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function g(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:t}=e;const r=(0,a.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(s),(0,i.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})}),[s,r])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,s=h(e),[a,l]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:s}))),[c,u]=p({queryString:t,groupId:r}),[m,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,s]=(0,d.Dv)(t);return[r,(0,i.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),x=(()=>{const e=c??m;return g({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{x&&l(x)}),[x]);return{selectedValue:a,selectValue:(0,i.useCallback)((e=>{if(!g({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var f=t(2303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(4848);function y(e){let{className:n,block:t,selectedValue:i,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),d=e=>{const n=e.currentTarget,t=l.indexOf(n),r=o[t].value;r!==i&&(c(n),a(r))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>l.push(e),onKeyDown:u,onClick:d,...s,className:(0,r.A)("tabs__item",x.tabItem,s?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:r}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===r));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function v(e){const n=m(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",x.tabList),children:[(0,b.jsx)(y,{...n,...e}),(0,b.jsx)(j,{...n,...e})]})}function k(e){const n=(0,f.A)();return(0,b.jsx)(v,{...e,children:u(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);