<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/gatk-sv/blog/rss.xml" title="GATK-SV Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/gatk-sv/blog/atom.xml" title="GATK-SV Blog Atom Feed"><title data-react-helmet="true">Pipeline Overview | GATK-SV</title><meta data-react-helmet="true" property="og:url" content="https://github.com/gatk-sv/docs/getting_started/overview"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Pipeline Overview | GATK-SV"><meta data-react-helmet="true" name="description" content="The pipeline consists of a series of modules that perform the following:"><meta data-react-helmet="true" property="og:description" content="The pipeline consists of a series of modules that perform the following:"><link data-react-helmet="true" rel="shortcut icon" href="/gatk-sv/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/gatk-sv/docs/getting_started/overview"><link data-react-helmet="true" rel="alternate" href="https://github.com/gatk-sv/docs/getting_started/overview" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/gatk-sv/docs/getting_started/overview" hreflang="x-default"><link rel="stylesheet" href="/gatk-sv/assets/css/styles.0c6acd5c.css">
<link rel="preload" href="/gatk-sv/assets/js/runtime~main.d7abc322.js" as="script">
<link rel="preload" href="/gatk-sv/assets/js/main.208362c9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/gatk-sv/"><img src="/gatk-sv/img/logo.svg" alt="GATK-SV Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/gatk-sv/img/logo.svg" alt="GATK-SV Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GATK-SV</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/gatk-sv/docs/intro">Docs</a><a href="https://github.com/broadinstitute/gatk-sv" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/gatk-sv/"><img src="/gatk-sv/img/logo.svg" alt="GATK-SV Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/gatk-sv/img/logo.svg" alt="GATK-SV Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GATK-SV</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/gatk-sv/docs/intro">Docs</a></li><li class="menu__list-item"><a href="https://github.com/broadinstitute/gatk-sv" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/gatk-sv/docs/intro">Welcome</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gatk-sv/docs/getting_started/quick_start">Quick Start</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/gatk-sv/docs/getting_started/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Modules</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/00a">Module 00a</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/00b">Module 00b</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/00c">Module 00c</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/01">Module 01</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/02">Module 02</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/03">Module 03</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/04">Module 04</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/0506">Module 05/06</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/07">Module 07 (in development)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/08">Module 08 (in development)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/09">Module 09 (in development)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gatk-sv/docs/modules/troubleshooting">Troubleshooting</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Pipeline Overview</h1></header><p>The pipeline consists of a series of modules that perform the following:</p><ul><li><a href="#module00a">Module 00a</a>: SV evidence collection, including calls from a configurable set of algorithms (Delly, Manta, MELT, and Wham), read depth (RD), split read positions (SR), and discordant pair positions (PE).</li><li><a href="#module00b">Module 00b</a>: Dosage bias scoring and ploidy estimation</li><li><a href="#module00c">Module 00c</a>: Copy number variant calling using cn.MOPS and GATK gCNV; B-allele frequency (BAF) generation; call and evidence aggregation</li><li><a href="#module01">Module 01</a>: Variant clustering</li><li><a href="#module02">Module 02</a>: Variant filtering metric generation</li><li><a href="#module03">Module 03</a>: Variant filtering; outlier exclusion</li><li><a href="#module04">Module 04</a>: Genotyping</li><li><a href="#module0506">Module 05/06</a>: Cross-batch integration; complex variant resolution and re-genotyping; vcf cleanup</li><li><a href="#module07">Module 07</a>: Downstream filtering, including minGQ, batch effect check, outlier samples removal and final recalibration;</li><li><a href="#module08">Module 08</a>: Annotations, including functional annotation, allele frequency (AF) annotation and AF annotation with external population callsets;</li><li><a href="#module09">Module 09</a>: Visualization, including scripts that generates IGV screenshots and rd plots.</li><li>Additional modules to be added: de novo and mosaic scripts</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="repository-structure"></a>Repository structure<a class="hash-link" href="#repository-structure" title="Direct link to heading">#</a></h2><ul><li><code>/inputs</code>: Example workflow parameter files for running gCNV training, GATK-SV batch mode, and GATK-SV single-sample mode</li><li><code>/dockerfiles</code>: Resources for building pipeline docker images (see <a href="https://github.com/talkowski-lab/gatk-sv-v1/blob/master/dockerfiles/README.md" target="_blank" rel="noopener noreferrer">readme</a>)</li><li><code>/wdl</code>: WDLs running the pipeline. There is a master WDL for running each module, e.g. <code>Module01.wdl</code>.</li><li><code>/scripts</code>: scripts for running tests, building dockers, and analyzing cromwell metadata files</li><li><code>/src</code>: main pipeline scripts<ul><li><code>/RdTest</code>: scripts for depth testing</li><li><code>/sv-pipeline</code>: various scripts and packages used throughout the pipeline</li><li><code>/svqc</code>: Python module for checking that pipeline metrics fall within acceptable limits</li><li><code>/svtest</code>: Python module for generating various summary metrics from module outputs</li><li><code>/svtk</code>: Python module of tools for SV-related datafile parsing and analysis</li><li><code>/WGD</code>: whole-genome dosage scoring scripts</li></ul></li><li><code>/test</code>: WDL test parameter files. Please note that file inputs may not be publicly available.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cohort-mode"></a>Cohort mode<a class="hash-link" href="#cohort-mode" title="Direct link to heading">#</a></h2><p>A minimum cohort size of 100 with roughly equal number of males and females is recommended. For modest cohorts (~100-500 samples), the pipeline can be run as a single batch using <code>GATKSVPipelineBatch.wdl</code>.</p><p>For larger cohorts, samples should be split up into batches of ~100-500 samples. We recommend batching based on overall coverage and dosage score (WGD), which can be generated in <a href="#module00b">Module 00b</a>.</p><p>The pipeline should be executed as follows:</p><ul><li>Modules <a href="#module00a">00a</a> and <a href="#module00b">00b</a> can be run on arbitrary cohort partitions</li><li>Modules <a href="#module00c">00c</a>, <a href="#module01">01</a>, <a href="#module02">02</a>, and <a href="#module03">03</a> are run separately per batch</li><li><a href="#module04">Module 04</a> is run separately per batch, using filtered variants (<a href="#module03">Module 03</a> output) combined across all batches</li><li><a href="#module0506">Module 05/06</a> and beyond are run on all batches together</li></ul><p>Note: <a href="#module00c">Module 00c</a> requires a <a href="#gcnv-training">trained gCNV model</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="single-sample-mode"></a>Single-sample mode<a class="hash-link" href="#single-sample-mode" title="Direct link to heading">#</a></h2><p><code>GATKSVPipelineSingleSample.wdl</code> runs the pipeline on a single sample using a fixed reference panel. An example reference panel containing 156 samples from the <a href="https://app.terra.bio/#workspaces/anvil-datastorage/1000G-high-coverage-2019" target="_blank" rel="noopener noreferrer">NYGC 1000G Terra workspace</a> is provided with <code>inputs/GATKSVPipelineSingleSample.ref_panel_1kg.na12878.json</code>.</p><p>Custom reference panels can be generated by running <code>GATKSVPipelineBatch.wdl</code> and <code>trainGCNV.wdl</code> and using the outputs to replace the following single-sample workflow inputs:</p><ul><li><code>GATKSVPipelineSingleSample.ref_ped_file</code> : <code>batch.ped</code> - Manually created (see <a href="#requirements">data requirements</a>)</li><li><code>GATKSVPipelineSingleSample.contig_ploidy_model_tar</code> : <code>batch-contig-ploidy-model.tar.gz</code> - gCNV contig ploidy model (<a href="#gcnv-training">gCNV training</a>)</li><li><code>GATKSVPipelineSingleSample.gcnv_model_tars</code> : <code>batch-model-files-*.tar.gz</code> - gCNV model tarballs (<a href="#gcnv-training">gCNV training</a>)</li><li><code>GATKSVPipelineSingleSample.ref_pesr_disc_files</code> - <code>sample.disc.txt.gz</code> - Paired-end evidence files (<a href="#module00a">Module 00a</a>)</li><li><code>GATKSVPipelineSingleSample.ref_pesr_split_files</code> - <code>sample.split.txt.gz</code> - Split read evidence files (<a href="#module00a">Module 00a</a>)</li><li><code>GATKSVPipelineSingleSample.ref_panel_bincov_matrix</code>: <code>batch.RD.txt.gz</code> - Read counts matrix (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.ref_panel_del_bed</code> : <code>batch.DEL.bed.gz</code> - Depth deletion calls (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.ref_panel_dup_bed</code> : <code>batch.DUP.bed.gz</code> - Depth duplication calls (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.ref_samples</code> - Reference panel sample IDs</li><li><code>GATKSVPipelineSingleSample.ref_std_manta_vcfs</code> - <code>std_XXX.manta.sample.vcf.gz</code> - Standardized Manta VCFs (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.ref_std_melt_vcfs</code> - <code>std_XXX.melt.sample.vcf.gz</code> - Standardized Melt VCFs (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.ref_std_wham_vcfs</code> - <code>std_XXX.wham.sample.vcf.gz</code> - Standardized Wham VCFs (<a href="#module00c">Module 00c</a>)</li><li><code>GATKSVPipelineSingleSample.cutoffs</code> : <code>batch.cutoffs</code> - Filtering cutoffs (<a href="#module03">Module 03</a>)</li><li><code>GATKSVPipelineSingleSample.genotype_pesr_pesr_sepcutoff</code> : <code>genotype_pesr.pesr_sepcutoff.txt</code> - Genotyping cutoffs (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.genotype_pesr_depth_sepcutoff</code> : <code>genotype_pesr.depth_sepcutoff.txt</code> - Genotyping cutoffs (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.genotype_depth_pesr_sepcutoff</code> : <code>genotype_depth.pesr_sepcutoff.txt</code> - Genotyping cutoffs (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.genotype_depth_depth_sepcutoff</code> : <code>genotype_depth.depth_sepcutoff.txt</code> - Genotyping cutoffs (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.PE_metrics</code> : <code>pe_metric_file.txt</code> - Paired-end evidence genotyping metrics (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.SR_metrics</code> : <code>sr_metric_file.txt</code> - Split read evidence genotyping metrics (<a href="#module04">Module 04</a>)</li><li><code>GATKSVPipelineSingleSample.ref_panel_vcf</code> : <code>batch.cleaned.vcf.gz</code> - Final output VCF (<a href="#module0506">Module 05/06</a>)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gcnv-training"></a>gCNV Training<a class="hash-link" href="#gcnv-training" title="Direct link to heading">#</a></h2><p>Both the cohort and single-sample modes use the GATK gCNV depth calling pipeline, which requires a <a href="#gcnv-training">trained model</a> as input. The samples used for training should be technically homogeneous and similar to the samples to be processed (i.e. same sample type, library prep protocol, sequencer, sequencing center, etc.). The samples to be processed may comprise all or a subset of the training set. For small cohorts, a single gCNV model is usually sufficient. If a cohort contains multiple data sources, we recommend clustering them using the dosage score, and training a separate model for each cluster.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="whats-next"></a>What&#x27;s next?<a class="hash-link" href="#whats-next" title="Direct link to heading">#</a></h2><ul><li>suggestion 1</li><li>suggestion 2</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/broadinstitute/gatk-sv/docs/getting_started/overview.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/gatk-sv/docs/getting_started/quick_start"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Quick Start</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/gatk-sv/docs/modules/00a"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Module 00a Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#repository-structure" class="table-of-contents__link">Repository structure</a></li><li><a href="#cohort-mode" class="table-of-contents__link">Cohort mode</a></li><li><a href="#single-sample-mode" class="table-of-contents__link">Single-sample mode</a></li><li><a href="#gcnv-training" class="table-of-contents__link">gCNV Training</a></li><li><a href="#whats-next" class="table-of-contents__link">What&#39;s next?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/gatk-sv/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/gatk-sv/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/gatk-sv/assets/js/runtime~main.d7abc322.js"></script>
<script src="/gatk-sv/assets/js/main.208362c9.js"></script>
</body>
</html>